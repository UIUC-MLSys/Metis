Winner:
[(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (4, 1), (1, 4)]
[(0, 1, 2), (3, 4), (5, 6), (7), (), (8), (9,)] 
cost: 9171.329266296885


[(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
[(0, 1), (2, 3), (4, 5), (6, 7), (), (8), (9,)]
|
|-------[(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)]
|       [(0, 1), (2, 3), (4, 5), (6, 7), (), (8), (9,)]	
|       |
|       |-------[(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (1,4)]
|       |       [(0, 1), (2, 3), (4, 5), (6, 7), (), (8), (9,)]	
|       | 		|
|       |  		|-------[(4, 1), (4, 1), (4, 1), (8, 1), (2, 2), (4, 1), (1, 4)]
|       |  		|		[(0, 1), (2, 3), (4, 5), (6, 7), (), (8), (9,)]	
|       |  		|		|
|       |  		|		|-------[(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (4, 1), (1, 4)]
|       |  		|		|		[(0, 1), (2, 3), (4, 5), (6, 7), (), (8), (9,)]
|       |  		|		|		|
|       |  		|		|		|-------[(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (2, 2), (1, 4)]
|       |  		|		|		|		[(0, 1), (2, 3), (4, 5), (6, 7), (), (8), (9,)]
|       |  		|		|		|		|
|       | 		|		|		|		|-------[(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)]
|       |  		|		| 		|		|       [(0, 1), (2, 3), (4, 5), (6, 7), (), (8), (9,)]
|       |  		|		| 		|		|		|
|       |  		|		| 		|		|		|-------[(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (1, 4), (1, 4)]
|       |  		|		|		| 		|		|		[(0, 1), (2, 3), (4, 5), (6, 7), (), (8), (9,)] (cost: 9905.066252869316)
|       |  		|		|		|		|		| 
|       |  		|		| 		|		|		 [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)]
|       |  		|		| 		|		|		 [(0, 1, 2), (3, 4), (5, 6), (7), (), (8), (9,)] (cost: 9907.531385437509)
|       |  		|		|		|		|
|       |  		|		|		|		[(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (2, 2), (1, 4)]
|       |  		|		|		|		[(0, 1, 2), (3, 4), (5, 6), (7), (), (8), (9,)] (cost: 9449.586636292002)
|       |  		|		|		|
|       |  		|		|		[(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (4, 1), (1, 4)]
|       |  		|		|		[(0, 1, 2), (3, 4), (5, 6), (7), (), (8), (9,)] (cost: 9171.329266296885)
|       |  		|		|
|       |  		|		  [(4, 1), (4, 1), (4, 1), (8, 1), (2, 2), (4, 1), (1, 4)]
|       |  		|		  [(0, 1, 2), (3, 4), (5, 6), (7), (), (8), (9)] (cost: 9905.931385437509)	 
|       |  		|
|       |	    [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (1,4)]
|       |	    [(0, 1, 2), (3, 4), (5, 6), (7), (), (8), (9)] (cost: 9905.611385437509)
|       |	
|       [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)]
|       [(0, 1, 2), (3, 4), (5, 6), (7), (), (8), (9)] (cost: 10127.205242249032)
|
[(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
[(0, 1, 2), (3, 4), (5. 6), (7), (), (8), (9,)] (cost: 9976.20963933613)

inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=8, gbs=128)
NAIVE STRATEGY: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
profile_cost of (8, (8, 1)): [708.9543342590332, 708.9543342590332, 708.9543342590332, 708.9543342590332, 828.6713361740112, 828.6713361740112, 828.6713361740112, 828.6713361740112]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20059862743701, 0.20059862743701, 0.20059862743701, 0.22626243702867543, 0.05731389355343144, 0.05731389355343144, 0.05731389355343144]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (2, 3)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (4, 5)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (6, 7)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 497520.001, 0.001, 0.001, 20730.001], memory_state: [267849.999, 286219.999, 286219.999, -104304.00099999999, 65535.999, 65535.999, 44805.998999999996]
MEMORY EXCEEDED
TESTING NEW PARTITION
current partition: [[0, 1], [2, 3], [4, 5], [6, 7], [], [], [9]]
MP strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
adj_stage_compute_performance(2): [0.2229967673043395, 0.2171898421535504, 0.2128884161159288, 0.16094430220665817, 0.05991490703045129, 0.05972223936548685, 0.05954384337940868]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1, 2)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (3, 4)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (5, 6)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (7,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (8,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
new partition: [[0, 1, 2], [3, 4], [5, 6], [7], [], [8], [9]]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 248760.001, 0.001, 20730.001, 60660.001], memory_state: [247119.999, 286219.999, 286219.999, 144455.999, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
data loadbalancer: [3, 3, 3, 3, 1, 1, 1, 1]
execution_cost: 4071.3407397270203, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 5.5373913043478264
cost: 9976.20963933613
NAIVE STRATEGY: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
TESTING NEW STRATEGY
curr_strategy: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
next_strategy: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)]
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)]
profile_cost of (8, (8, 1)): [708.9543342590332, 708.9543342590332, 708.9543342590332, 708.9543342590332, 828.6713361740112, 828.6713361740112, 828.6713361740112, 828.6713361740112]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20154796978882072, 0.20154796978882072, 0.20154796978882072, 0.22733323455525709, 0.05758513422537736, 0.05758513422537736, 0.05285258762752592]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (2, 3)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (4, 5)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (6, 7)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 497520.001, 0.001, 0.001, 20730.001], memory_state: [267849.999, 286219.999, 286219.999, -104304.00099999999, 65535.999, 65535.999, 44805.998999999996]
MEMORY EXCEEDED
TESTING NEW PARTITION
current partition: [[0, 1], [2, 3], [4, 5], [6, 7], [], [], [9]]
MP strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)]
adj_stage_compute_performance(2): [0.224182704506104, 0.2182784971129581, 0.21391438574376342, 0.16170597861650987, 0.06019675447086084, 0.06000211622691448, 0.05490560525159941]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1, 2)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (3, 4)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (5, 6)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (7,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
new partition: [[0, 1, 2], [3, 4], [5, 6], [7], [], [], [9]]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 248760.001, 0.001, 0.001, 20730.001], memory_state: [247119.999, 286219.999, 286219.999, 144455.999, 65535.999, 65535.999, 44805.998999999996]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)], layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
data loadbalancer: [3, 3, 3, 3, 1, 1, 1, 1]
execution_cost: 4345.865547657013, fb_sync_cost: 5740.291595458984, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 1.8573913043478263
cost: 10127.205242249032
NAIVE STRATEGY: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
TESTING NEW STRATEGY
curr_strategy: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)]
next_strategy: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (1, 4)]
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (1, 4)]
profile_cost of (8, (8, 1)): [708.9543342590332, 708.9543342590332, 708.9543342590332, 708.9543342590332, 828.6713361740112, 828.6713361740112, 828.6713361740112, 828.6713361740112]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20286403853612214, 0.20286403853612214, 0.20286403853612214, 0.22881767602859268, 0.05796115386746348, 0.05796115386746348, 0.046667900628113775]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (2, 3)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (4, 5)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (6, 7)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 497520.001, 0.001, 0.001, 20730.001], memory_state: [267849.999, 286219.999, 286219.999, -104304.00099999999, 65535.999, 65535.999, 44805.998999999996]
MEMORY EXCEEDED
TESTING NEW PARTITION
current partition: [[0, 1], [2, 3], [4, 5], [6, 7], [], [], [9]]
MP strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (1, 4)]
adj_stage_compute_performance(2): [0.22582879368951625, 0.21978778000235155, 0.21533589043711843, 0.1627618869689084, 0.06058717044644298, 0.0603898021377285, 0.04847637776719089]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1, 2)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (3, 4)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (5, 6)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (7,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
new partition: [[0, 1, 2], [3, 4], [5, 6], [7], [], [], [9]]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 248760.001, 0.001, 0.001, 20730.001], memory_state: [247119.999, 286219.999, 286219.999, 144455.999, 65535.999, 65535.999, 44805.998999999996]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (1, 4)], layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
data loadbalancer: [3, 3, 3, 3, 1, 1, 1, 1]
execution_cost: 4816.036522388458, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 1.8573913043478263
cost: 9905.611385437509
NAIVE STRATEGY: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
TESTING NEW STRATEGY
curr_strategy: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (1, 4)]
next_strategy: [(4, 1), (4, 1), (4, 1), (8, 1), (2, 2), (4, 1), (1, 4)]
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (2, 2), (4, 1), (1, 4)]
profile_cost of (8, (8, 1)): [708.9543342590332, 708.9543342590332, 708.9543342590332, 708.9543342590332, 828.6713361740112, 828.6713361740112, 828.6713361740112, 828.6713361740112]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20383499618558215, 0.20383499618558215, 0.20383499618558215, 0.2299128542300858, 0.05345232208859714, 0.05823857033873776, 0.046891264785832824]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (2, 3)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (4, 5)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (6, 7)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 497520.001, 0.001, 0.001, 20730.001], memory_state: [267849.999, 286219.999, 286219.999, -104304.00099999999, 65535.999, 65535.999, 44805.998999999996]
MEMORY EXCEEDED
TESTING NEW PARTITION
current partition: [[0, 1], [2, 3], [4, 5], [6, 7], [], [], [9]]
MP strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (2, 2), (4, 1), (1, 4)]
adj_stage_compute_performance(2): [0.22704532962091103, 0.22090176748869764, 0.21638434983982527, 0.16354090576560293, 0.055872120431026795, 0.060692043645728146, 0.04871730494767102]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1, 2)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (3, 4)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (5, 6)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (7,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
new partition: [[0, 1, 2], [3, 4], [5, 6], [7], [], [], [9]]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 248760.001, 0.001, 0.001, 20730.001], memory_state: [247119.999, 286219.999, 286219.999, 144455.999, 65535.999, 65535.999, 44805.998999999996]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (2, 2), (4, 1), (1, 4)], layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
data loadbalancer: [3, 3, 3, 3, 1, 1, 1, 1]
execution_cost: 4816.036522388458, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 2.177391304347826
cost: 9905.931385437509
NAIVE STRATEGY: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
TESTING NEW STRATEGY
curr_strategy: [(4, 1), (4, 1), (4, 1), (8, 1), (2, 2), (4, 1), (1, 4)]
next_strategy: [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (4, 1), (1, 4)]
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (4, 1), (1, 4)]
profile_cost of (8, (8, 1)): [708.9543342590332, 708.9543342590332, 708.9543342590332, 708.9543342590332, 828.6713361740112, 828.6713361740112, 828.6713361740112, 828.6713361740112]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.2051812018080951, 0.2051812018080951, 0.2051812018080951, 0.23143128817344433, 0.047200952942835855, 0.058623200516598604, 0.047200952942835855]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (2, 3)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (4, 5)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (6, 7)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (8,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 497520.001, 0.001, 20730.001, 60660.001], memory_state: [267849.999, 286219.999, 286219.999, -104304.00099999999, 65535.999, 44805.998999999996, 4875.999000000003]
MEMORY EXCEEDED
TESTING NEW PARTITION
current partition: [[0, 1], [2, 3], [4, 5], [6, 7], [], [8], [9]]
MP strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (4, 1), (1, 4)]
adj_stage_compute_performance(2): [0.2287341550674257, 0.22244633306593634, 0.21783714155664444, 0.16462099353744006, 0.0493351381741097, 0.06111105454904152, 0.049051279809295245]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1, 2)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (3, 4)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (5, 6)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (7,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (8,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
new partition: [[0, 1, 2], [3, 4], [5, 6], [7], [], [8], [9]]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 248760.001, 0.001, 20730.001, 60660.001], memory_state: [247119.999, 286219.999, 286219.999, 144455.999, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (4, 1), (1, 4)], layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
data loadbalancer: [3, 3, 3, 3, 1, 1, 1, 1]
execution_cost: 4077.1144032478333, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 6.497391304347826
cost: 9171.329266296885
NAIVE STRATEGY: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
TESTING NEW STRATEGY
curr_strategy: [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (4, 1), (1, 4)]
next_strategy: [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (2, 2), (1, 4)]
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (2, 2), (1, 4)]
profile_cost of (8, (8, 1)): [708.9543342590332, 708.9543342590332, 708.9543342590332, 708.9543342590332, 828.6713361740112, 828.6713361740112, 828.6713361740112, 828.6713361740112]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20617452147801718, 0.20617452147801718, 0.20617452147801718, 0.23255168930547931, 0.047429461376279174, 0.05406582350791084, 0.047429461376279174]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (2, 3)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (4, 5)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (6, 7)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 497520.001, 0.001, 0.001, 20730.001], memory_state: [267849.999, 286219.999, 286219.999, -104304.00099999999, 65535.999, 65535.999, 44805.998999999996]
MEMORY EXCEEDED
TESTING NEW PARTITION
current partition: [[0, 1], [2, 3], [4, 5], [6, 7], [], [], [9]]
MP strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (2, 2), (1, 4)]
adj_stage_compute_performance(2): [0.22998249035915183, 0.22358649401251932, 0.2189087781907976, 0.1654179538316672, 0.04957191991103223, 0.05635712261821692, 0.049297907011338946]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1, 2)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (3, 4)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (5, 6)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (7,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (8,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
new partition: [[0, 1, 2], [3, 4], [5, 6], [7], [], [8], [9]]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 248760.001, 0.001, 20730.001, 60660.001], memory_state: [247119.999, 286219.999, 286219.999, 144455.999, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (2, 2), (1, 4)], layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
data loadbalancer: [3, 3, 3, 3, 1, 1, 1, 1]
execution_cost: 4355.37177324295, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 6.497391304347826
cost: 9449.586636292002
NAIVE STRATEGY: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
TESTING NEW STRATEGY
curr_strategy: [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (2, 2), (1, 4)]
next_strategy: [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)]
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)]
profile_cost of (8, (8, 1)): [708.9543342590332, 708.9543342590332, 708.9543342590332, 708.9543342590332, 828.6713361740112, 828.6713361740112, 828.6713361740112, 828.6713361740112]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20755191112133053, 0.20755191112133053, 0.20755191112133053, 0.23410529683219083, 0.047746323267939164, 0.047746323267939164, 0.047746323267939164]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (2, 3)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (4, 5)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (6, 7)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 497520.001, 0.001, 0.001, 20730.001], memory_state: [267849.999, 286219.999, 286219.999, -104304.00099999999, 65535.999, 65535.999, 44805.998999999996]
MEMORY EXCEEDED
TESTING NEW PARTITION
current partition: [[0, 1], [2, 3], [4, 5], [6, 7], [], [], [9]]
MP strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)]
adj_stage_compute_performance(2): [0.23171573902054668, 0.2251675168697135, 0.22039381544115602, 0.16652306116885154, 0.04989997004366595, 0.04976571044540329, 0.04963982066893723]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1, 2)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (3, 4)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (5, 6)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (7,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
new partition: [[0, 1, 2], [3, 4], [5, 6], [7], [], [], [9]]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 248760.001, 0.001, 0.001, 20730.001], memory_state: [247119.999, 286219.999, 286219.999, 144455.999, 65535.999, 65535.999, 44805.998999999996]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
data loadbalancer: [3, 3, 3, 3, 1, 1, 1, 1]
execution_cost: 4816.036522388458, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 3.7773913043478267
cost: 9907.531385437509
NAIVE STRATEGY: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
TESTING NEW STRATEGY
curr_strategy: [(4, 1), (4, 1), (4, 1), (8, 1), (1, 4), (1, 4), (1, 4)]
next_strategy: [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (1, 4), (1, 4)]
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (1, 4), (1, 4)]
profile_cost of (8, (4, 2)): [769.3133354187012, 769.3133354187012, 910.4272127151489, 910.4272127151489]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.21200887412006214, 0.21200887412006214, 0.21200887412006214, 0.21765849885041785, 0.04877162626313193, 0.04877162626313193, 0.04877162626313193]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (2, 3)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (4, 5)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (6, 7)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 248760.001, 0.001, 0.001, 20730.001], memory_state: [267849.999, 286219.999, 286219.999, 144455.999, 65535.999, 65535.999, 44805.998999999996]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 8, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
data loadbalancer: [6, 6, 2, 2]
execution_cost: 4821.883916854858, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 3.9513043478260874
cost: 9905.066252869316