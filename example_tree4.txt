Winner:
[(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (4, 1), (1, 4)]
[[0, 1, 2], [3, 4], [5, 6], [7], [], [8], [9]] 
cost: 14869.341366457731


[(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
[[0, 1], [2, 3], [4, 5], [6, 7], [], [8], [9]]
|
|-------[(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)]
|       [[0, 1], [2, 3], [4, 5], [6, 7], [], [8], [9]]
|       |
|       |-------[(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (2, 2)]
|       |       [[0, 1], [2, 3], [4, 5], [6, 7], [], [8], [9]]
|       |       |
|       |       |-------[(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (1, 4)]
|       |       |       [[0, 1], [2, 3], [4, 5], [6, 7], [], [8], [9]]
|       |       |       |
|       |       |       |-------[(4, 1), (4, 1), (4, 1), (4, 2), (2, 2), (4, 1), (1, 4)]
|       |       |       |       [[0, 1], [2, 3], [4, 5], [6, 7], [], [8], [9]]
|       |       |       |       |
|       |       |       |       |-------[(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (4, 1), (1, 4)]
|       |       |       |       |       [[0, 1], [2, 3], [4, 5], [6, 7], [], [8], [9]]
|       |       |       |       |       |
|       |       |       |       |       |-------[(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (2, 2), (1, 4)]
|       |       |       |       |       |       [[0, 1], [2, 3], [4, 5], [6, 7], [], [8], [9]]
|       |       |       |       |       |       |
|       |       |       |       |       |       |-------[(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (1, 4), (1, 4)]
|       |       |       |       |       |       |       [[0, 1], [2, 3], [4, 5], [6, 7], [], [8], [9]]
|       |       |       |       |       |       |       |
|       |       |       |       |       |       |       |-------[(4, 1), (4, 1), (4, 1), (2, 4), (1, 4), (1, 4), (1, 4)]
|       |       |       |       |       |       |       |       [[0, 1], [2, 3], [4, 5], [6, 7], [], [8], [9]] (cost: 15581.6591531936)
|       |       |       |       |       |       |       |
|       |       |       |       |       |       |       [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (1, 4), (1, 4)]
|       |       |       |       |       |       |       [[0, 1, 2], [3, 4], [5, 6], [7], [], [], [9]] (cost: 15519.959906496795)
|       |       |       |       |       |       |
|       |       |       |       |       |       [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (2, 2), (1, 4)]
|       |       |       |       |       |       [[0, 1, 2], [3, 4], [5, 6], [7], [], [8], [9]] (cost: 15147.598736452848)
|       |       |       |       |       |
|       |       |       |       |       [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (4, 1), (1, 4)]
|       |       |       |       |       [[0, 1, 2], [3, 4], [5, 6], [7], [], [8], [9]] (cost: 14869.341366457731)
|       |       |       |       |
|       |       |       |       [(4, 1), (4, 1), (4, 1), (4, 2), (2, 2), (4, 1), (1, 4)]
|       |       |       |       [[0, 1, 2], [3, 4], [5, 6], [7], [], [], [9]] (cost: 15507.159906496794)
|       |       |       |
|       |       |       [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (1, 4)]
|       |       |       [[0, 1, 2], [3, 4], [5, 6], [7], [], [], [9]] (cost: 15504.599906496795)
|       |       |
|       |       [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (2, 2)]
|       |       [[0, 1, 2], [3, 4], [5, 6], [7], [], [8], [9]] (cost: 15514.893940920623)
|       |
|       [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)]
|       [[0, 1, 2], [3, 4], [5, 6], [7], [], [8], [9]]
|       |
|       [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)]
|       [[0, 1, 2], [3, 4], [5, 6], [7], [], [8], [9]]
|       |
|       [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)]
|       [[0, 1, 2], [3, 4], [5, 6], [7], [], [8], [9]]
|
[(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
[[0, 1, 2], [3, 4], [5, 6], [7], [], [8], [9]]
|
[(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
[[0, 1, 2], [3, 4], [5, 6], [], [7], [8], [9]] (cost: 18098.272123953775)




inter_stage_plan: InterStagePlan(ns_idx=0, node_sequence=(<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), dg_idx=3, device_groups=[4, 4, 4, 8, 4, 4, 4], num_stage=7, batches=1, gbs=128)
NAIVE STRATEGY: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
profile_cost of (8, (8, 1)): [5844.893217086792, 5844.893217086792, 5844.893217086792, 5844.893217086792, 5752.74932384491, 5752.74932384491, 5752.74932384491, 5752.74932384491]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.1946863889308981, 0.1946863889308981, 0.1946863889308981, 0.24906678555224995, 0.05562468255168518, 0.05562468255168518, 0.05562468255168518]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (2, 3)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (4, 5)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (6, 7)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (8,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 995040.0009999999, 0.001, 20730.001, 60660.001], memory_state: [267849.999, 286219.999, 286219.999, -601824.0009999999, 65535.999, 44805.998999999996, 4875.999000000003]
MEMORY EXCEEDED
TESTING NEW PARTITION
current partition: [[0, 1], [2, 3], [4, 5], [6, 7], [], [8], [9]]
MP strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
adj_stage_compute_performance(2): [0.2553719463374355, 0.23924294989744382, 0.22740634218521016, 0.08858271078987726, 0.06249093100069903, 0.061970263217200824, 0.0597670570341657]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1, 2)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (3, 4)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (5, 6)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (7,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (8,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
new partition: [[0, 1, 2], [3, 4], [5, 6], [7], [], [8], [9]]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 497520.001, 0.001, 20730.001, 60660.001], memory_state: [247119.999, 286219.999, 286219.999, -104304.00099999999, 65535.999, 44805.998999999996, 4875.999000000003]
MEMORY EXCEEDED
TESTING NEW PARTITION
current partition: [[0, 1, 2], [3, 4], [5, 6], [7], [], [8], [9]]
MP strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
adj_stage_compute_performance(3): [0.26257797013708856, 0.24409151428199768, 0.23079836611970359, 0.0630103819391115, 0.06318915535596463, 0.06261492474885011, 0.06034628379018124]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1, 2)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (3, 4)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (5, 6)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (7,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (8,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
new partition: [[0, 1, 2], [3, 4], [5, 6], [], [7], [8], [9]]
layer_partition: [0, 3, 5, 7, 7, 8, 9, 10]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 0.001, 20730.001, 20730.001, 60660.001], memory_state: [247119.999, 286219.999, 286219.999, 393215.999, 44805.998999999996, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 3, 5, 7, 7, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)], layer_partition: [0, 3, 5, 7, 7, 8, 9, 10]
data loadbalancer: [25, 25, 25, 25, 7, 7, 7, 7]
execution_cost: 12161.463737487793, fb_sync_cost: 5860.140800476074, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 44.29913043478261
cost: 18098.272123953775
NAIVE STRATEGY: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
TESTING NEW STRATEGY
curr_strategy: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
next_strategy: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)]
valid_strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)]
profile_cost of (8, (8, 1)): [5844.893217086792, 5844.893217086792, 5844.893217086792, 5844.893217086792, 5752.74932384491, 5752.74932384491, 5752.74932384491, 5752.74932384491]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.19558047133786488, 0.19558047133786488, 0.19558047133786488, 0.25021060578716675, 0.0558801346679614, 0.0558801346679614, 0.0512877108633157]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (2, 3)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (4, 5)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (6, 7)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (8,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
layer_partition: [0, 2, 4, 6, 8, 8, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 995040.0009999999, 0.001, 20730.001, 60660.001], memory_state: [267849.999, 286219.999, 286219.999, -601824.0009999999, 65535.999, 44805.998999999996, 4875.999000000003]
MEMORY EXCEEDED
TESTING NEW PARTITION
current partition: [[0, 1], [2, 3], [4, 5], [6, 7], [], [8], [9]]
MP strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)]
adj_stage_compute_performance(2): [0.25677560284481205, 0.2404464188135438, 0.22847930619804308, 0.08898952013958876, 0.0627736254371783, 0.06224869875184974, 0.05510210271017753]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1, 2)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (3, 4)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (5, 6)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (7,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (8,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
new partition: [[0, 1, 2], [3, 4], [5, 6], [7], [], [8], [9]]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 497520.001, 0.001, 20730.001, 60660.001], memory_state: [247119.999, 286219.999, 286219.999, -104304.00099999999, 65535.999, 44805.998999999996, 4875.999000000003]
MEMORY EXCEEDED
TESTING NEW PARTITION
current partition: [[0, 1, 2], [3, 4], [5, 6], [7], [], [8], [9]]
MP strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)]
adj_stage_compute_performance(3): [0.2640579146856259, 0.2453325758332936, 0.2318898263665248, 0.06329975231706851, 0.06347430129843265, 0.06289536469127176, 0.05563518956792716]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1, 2)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (3, 4)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (5, 6)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (7,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (8,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
new partition: [[0, 1, 2], [3, 4], [5, 6], [7], [], [8], [9]]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 497520.001, 0.001, 20730.001, 60660.001], memory_state: [247119.999, 286219.999, 286219.999, -104304.00099999999, 65535.999, 44805.998999999996, 4875.999000000003]
MEMORY EXCEEDED
TESTING NEW PARTITION
current partition: [[0, 1, 2], [3, 4], [5, 6], [7], [], [8], [9]]
MP strategies: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)]
adj_stage_compute_performance(4): [0.2692841222383357, 0.24879948112545866, 0.2342960274722213, 0.04502618552293653, 0.06396751910391126, 0.06335048532764398, 0.05601034985243196]
layer_partition: None
TESTING NEW STRATEGY
curr_strategy: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (2, 2)]
next_strategy: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (2, 2)]
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (2, 2)]
profile_cost of (8, (4, 2)): [6370.417356491089, 6370.417356491089, 6256.935596466064, 6256.935596466064]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.19970252900135652, 0.19970252900135652, 0.19970252900135652, 0.2344080305235014, 0.05705786542895901, 0.05705786542895901, 0.05236865161451095]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (2, 3)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (4, 5)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (6, 7)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (8,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 497520.001, 20730.001, 0.001, 60660.001], memory_state: [267849.999, 286219.999, 286219.999, -104304.00099999999, 44805.998999999996, 65535.999, 4875.999000000003]
MEMORY EXCEEDED
TESTING NEW PARTITION
current partition: [[0, 1], [2, 3], [4, 5], [6, 7], [8], [], [9]]
MP strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (2, 2)]
adj_stage_compute_performance(2): [0.22304167515339282, 0.2169537240030157, 0.2124537979229621, 0.1667384007689295, 0.05975076142991872, 0.05955006588482045, 0.05448556082415901]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1, 2)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (3, 4)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (5, 6)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (7,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (8,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
new partition: [[0, 1, 2], [3, 4], [5, 6], [7], [], [8], [9]]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 248760.001, 0.001, 20730.001, 60660.001], memory_state: [247119.999, 286219.999, 286219.999, 144455.999, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (2, 2)], layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
data loadbalancer: [50, 50, 14, 14]
execution_cost: 9696.543455123901, fb_sync_cost: 5740.291595458984, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 45.6904347826087
cost: 15514.893940920623
NAIVE STRATEGY: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
TESTING NEW STRATEGY
curr_strategy: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (2, 2)]
next_strategy: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (1, 4)]
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (1, 4)]
profile_cost of (8, (4, 2)): [6370.417356491089, 6370.417356491089, 6256.935596466064, 6256.935596466064]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.2009945301048871, 0.2009945301048871, 0.2009945301048871, 0.2359245633166877, 0.05742700860139632, 0.05742700860139632, 0.04623782916585822]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (2, 3)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (4, 5)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (6, 7)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (8,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
layer_partition: [0, 2, 4, 6, 8, 9, 9, 10]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 497520.001, 20730.001, 0.001, 60660.001], memory_state: [267849.999, 286219.999, 286219.999, -104304.00099999999, 44805.998999999996, 65535.999, 4875.999000000003]
MEMORY EXCEEDED
TESTING NEW PARTITION
current partition: [[0, 1], [2, 3], [4, 5], [6, 7], [8], [], [9]]
MP strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (1, 4)]
adj_stage_compute_performance(2): [0.22467255151159932, 0.21844390894835447, 0.21385374738461016, 0.16781713622046163, 0.06013458707789787, 0.05993108867316712, 0.04810247610533533]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1, 2)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (3, 4)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (5, 6)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (7,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
new partition: [[0, 1, 2], [3, 4], [5, 6], [7], [], [], [9]]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 248760.001, 0.001, 0.001, 20730.001], memory_state: [247119.999, 286219.999, 286219.999, 144455.999, 65535.999, 65535.999, 44805.998999999996]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (1, 4)], layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
data loadbalancer: [50, 50, 14, 14]
execution_cost: 10407.454252243042, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 16.250434782608696
cost: 15504.599906496795
NAIVE STRATEGY: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
TESTING NEW STRATEGY
curr_strategy: [(4, 1), (4, 1), (4, 1), (4, 2), (4, 1), (4, 1), (1, 4)]
next_strategy: [(4, 1), (4, 1), (4, 1), (4, 2), (2, 2), (4, 1), (1, 4)]
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (2, 2), (4, 1), (1, 4)]
profile_cost of (8, (4, 2)): [6370.417356491089, 6370.417356491089, 6256.935596466064, 6256.935596466064]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20194763231229765, 0.20194763231229765, 0.20194763231229765, 0.23704330133389725, 0.05295739244677383, 0.057699323517799335, 0.04645708576463657]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (2, 3)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (4, 5)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (6, 7)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 497520.001, 0.001, 0.001, 20730.001], memory_state: [267849.999, 286219.999, 286219.999, -104304.00099999999, 65535.999, 65535.999, 44805.998999999996]
MEMORY EXCEEDED
TESTING NEW PARTITION
current partition: [[0, 1], [2, 3], [4, 5], [6, 7], [], [], [9]]
MP strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (2, 2), (4, 1), (1, 4)]
adj_stage_compute_performance(2): [0.22587780394621987, 0.21954370725272923, 0.21488618779137242, 0.168612913512956, 0.055452237676600735, 0.060228888097262026, 0.04833975817884285]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1, 2)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (3, 4)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (5, 6)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (7,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
new partition: [[0, 1, 2], [3, 4], [5, 6], [7], [], [], [9]]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 248760.001, 0.001, 0.001, 20730.001], memory_state: [247119.999, 286219.999, 286219.999, 144455.999, 65535.999, 65535.999, 44805.998999999996]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (2, 2), (4, 1), (1, 4)], layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
data loadbalancer: [50, 50, 14, 14]
execution_cost: 10407.454252243042, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 18.810434782608695
cost: 15507.159906496794
NAIVE STRATEGY: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
TESTING NEW STRATEGY
curr_strategy: [(4, 1), (4, 1), (4, 1), (4, 2), (2, 2), (4, 1), (1, 4)]
next_strategy: [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (4, 1), (1, 4)]
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (4, 1), (1, 4)]
profile_cost of (8, (4, 2)): [6370.417356491089, 6370.417356491089, 6256.935596466064, 6256.935596466064]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.203268942779317, 0.203268942779317, 0.203268942779317, 0.2385942370472952, 0.04676104691033153, 0.05807684079409058, 0.04676104691033153]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (2, 3)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (4, 5)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (6, 7)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 497520.001, 0.001, 0.001, 20730.001], memory_state: [267849.999, 286219.999, 286219.999, -104304.00099999999, 65535.999, 65535.999, 44805.998999999996]
MEMORY EXCEEDED
TESTING NEW PARTITION
current partition: [[0, 1], [2, 3], [4, 5], [6, 7], [], [], [9]]
MP strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (4, 1), (1, 4)]
adj_stage_compute_performance(2): [0.22755087525903006, 0.22106844107748497, 0.21631659209352136, 0.16971612034409508, 0.04896128656242113, 0.060641695526744074, 0.04866864259661631]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1, 2)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (3, 4)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (5, 6)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (7,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (8,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
new partition: [[0, 1, 2], [3, 4], [5, 6], [7], [], [8], [9]]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 248760.001, 0.001, 20730.001, 60660.001], memory_state: [247119.999, 286219.999, 286219.999, 144455.999, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (4, 1), (1, 4)], layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
data loadbalancer: [50, 50, 14, 14]
execution_cost: 9735.07571220398, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 53.3704347826087
cost: 14869.341366457731
NAIVE STRATEGY: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
TESTING NEW STRATEGY
curr_strategy: [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (4, 1), (1, 4)]
next_strategy: [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (2, 2), (1, 4)]
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (2, 2), (1, 4)]
profile_cost of (8, (4, 2)): [6370.417356491089, 6370.417356491089, 6256.935596466064, 6256.935596466064]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.2042437895540715, 0.2042437895540715, 0.2042437895540715, 0.23973849853299142, 0.046985305742701065, 0.05355952131939203, 0.046985305742701065]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (2, 3)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (4, 5)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (6, 7)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 497520.001, 0.001, 0.001, 20730.001], memory_state: [267849.999, 286219.999, 286219.999, -104304.00099999999, 65535.999, 65535.999, 44805.998999999996]
MEMORY EXCEEDED
TESTING NEW PARTITION
current partition: [[0, 1], [2, 3], [4, 5], [6, 7], [], [], [9]]
MP strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (2, 2), (1, 4)]
adj_stage_compute_performance(2): [0.2287875231632727, 0.22219386407034752, 0.21737158747879598, 0.17053005291185042, 0.04919397510917549, 0.05592163105093298, 0.04891149407733553]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1, 2)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (3, 4)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (5, 6)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (7,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (8,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
new partition: [[0, 1, 2], [3, 4], [5, 6], [7], [], [8], [9]]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 248760.001, 0.001, 20730.001, 60660.001], memory_state: [247119.999, 286219.999, 286219.999, 144455.999, 65535.999, 44805.998999999996, 4875.999000000003]
layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (2, 2), (1, 4)], layer_partition: [0, 3, 5, 7, 8, 8, 9, 10]
data loadbalancer: [50, 50, 14, 14]
execution_cost: 10013.333082199097, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 53.3704347826087
cost: 15147.598736452848
NAIVE STRATEGY: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
TESTING NEW STRATEGY
curr_strategy: [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (2, 2), (1, 4)]
next_strategy: [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (1, 4), (1, 4)]
valid_strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (1, 4), (1, 4)]
profile_cost of (8, (4, 2)): [6370.417356491089, 6370.417356491089, 6256.935596466064, 6256.935596466064]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.20559541815459972, 0.20559541815459972, 0.20559541815459972, 0.24132502124671687, 0.047296241429827975, 0.047296241429827975, 0.047296241429827975]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (2, 3)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (4, 5)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (6, 7)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 497520.001, 0.001, 0.001, 20730.001], memory_state: [267849.999, 286219.999, 286219.999, -104304.00099999999, 65535.999, 65535.999, 44805.998999999996]
MEMORY EXCEEDED
TESTING NEW PARTITION
current partition: [[0, 1], [2, 3], [4, 5], [6, 7], [], [], [9]]
MP strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (1, 4), (1, 4)]
adj_stage_compute_performance(2): [0.23050444994536826, 0.22375428294333422, 0.21883336225396643, 0.1716585733788301, 0.04951630590911541, 0.049377905792408375, 0.04924813361983685]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1, 2)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (3, 4)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (5, 6)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (7,)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
new partition: [[0, 1, 2], [3, 4], [5, 6], [7], [], [], [9]]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
stage_memory_demand: [80560.001, 41460.001, 41460.001, 248760.001, 0.001, 0.001, 20730.001], memory_state: [247119.999, 286219.999, 286219.999, 144455.999, 65535.999, 65535.999, 44805.998999999996]
layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 3, 5, 7, 8, 8, 8, 9]
data loadbalancer: [50, 50, 14, 14]
execution_cost: 10407.454252243042, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 6.578121185302734, dp_cost: 24.815726902173914, pp_cost: 31.6104347826087
cost: 15519.959906496795
NAIVE STRATEGY: [(4, 1), (4, 1), (4, 1), (8, 1), (4, 1), (4, 1), (4, 1)]
TESTING NEW STRATEGY
curr_strategy: [(4, 1), (4, 1), (4, 1), (4, 2), (1, 4), (1, 4), (1, 4)]
next_strategy: [(4, 1), (4, 1), (4, 1), (2, 4), (1, 4), (1, 4), (1, 4)]
valid_strategies: [(4, 1), (4, 1), (4, 1), (2, 4), (1, 4), (1, 4), (1, 4)]
profile_cost of (8, (2, 4)): [7255.470752716064, 7110.361337661743]
stage_memory_capacity: [327680, 327680, 327680, 393216, 65536, 65536, 65536]
stage_compute_performance: [0.211831277571337, 0.211831277571337, 0.211831277571337, 0.2183138542033731, 0.04873077102753863, 0.04873077102753863, 0.04873077102753863]
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (0, 1)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (2, 3)
Testing Mapping: ('A100', 'A100', 'A100', 'A100') (4, 5)
Testing Mapping: ('A100', 'A100', 'A100', 'A100', 'V100', 'V100', 'V100', 'V100') (6, 7)
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') ()
Testing Mapping: ('V100', 'V100', 'V100', 'V100') (9,)
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
stage_memory_demand: [59830.001, 41460.001, 41460.001, 248760.001, 0.001, 0.001, 20730.001], memory_state: [267849.999, 286219.999, 286219.999, 144455.999, 65535.999, 65535.999, 44805.998999999996]
layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
node_sequence: (<DeviceType.A100: 'a100'>, <DeviceType.V100: 'v100'>), device_group: [4, 4, 4, 8, 4, 4, 4], num_stage: 7, batches: 1, gbs: 128, strategies: [(4, 1), (4, 1), (4, 1), (2, 4), (1, 4), (1, 4), (1, 4)], layer_partition: [0, 2, 4, 6, 8, 8, 8, 9]
data loadbalancer: [100, 28]
execution_cost: 10474.857330322266, fb_sync_cost: 5048.526763916016, parameter_upate_costs: 4.385414123535156, dp_cost: 18.521993885869566, pp_cost: 34.39304347826087
cost: 15581.6591531936